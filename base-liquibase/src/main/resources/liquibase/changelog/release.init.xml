<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

    <property name="autoIncrement" value="true" dbms="mysql" />
    <property name="now" value="now()" dbms="mysql,h2"/>
    <property name="now" value="current_timestamp" dbms="postgresql"/>
    <property name="now" value="sysdate" dbms="oracle"/>
    <property name="autoIncrement" value="true" dbms="mysql,h2,postgresql,oracle"/>

    <changeSet id="20170115.add.table.t_user" author="Gsean">
        <comment>init schema</comment>
        <createTable tableName="t_user">
            <column name="id" type="bigint" autoIncrement="${autoIncrement}">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="name" type="varchar(255)"/>
            <column name="email" type="varchar(255)"/>
        </createTable>
    </changeSet>
    
    
    <changeSet id="20200829.add.column.t_user" author="Gsean">
        <addColumn tableName="t_user">
            <column name="password" type="varchar(255)" remarks="用户名密码">
                <constraints nullable="false"/>
            </column>
            <column name="is_deleted" type="boolean" remarks="是否删除" defaultValueBoolean="false"/>
        </addColumn>
    </changeSet>


    <changeSet id="20200901.add.table.user_role" author="Gsean">
        <createTable tableName="user_role">
            <column name="id" type="bigint" autoIncrement="${autoIncrement}">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="user_id" type="bigint" remarks="用户id"/>
            <column name="role_id" type="bigint" remarks="角色id"/>
            <column name="is_deleted" type="boolean" remarks="是否删除" defaultValueBoolean="false"/>
        </createTable>
    </changeSet>

    <changeSet id="20200901.add.table.role" author="Gsean">
        <createTable tableName="role">
            <column name="id" type="bigint" autoIncrement="${autoIncrement}">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="name" type="varchar(255)" remarks="角色名"/>
            <column name="des" type="varchar(255)" remarks="角色描述"/>
            <column name="is_deleted" type="boolean" remarks="是否删除" defaultValueBoolean="false"/>
            <column name="create_time" type="datetime" remarks="创建时间" defaultValue="now()"/>
            <column name="modify_time" type="datetime" remarks="更新时间" defaultValue="now()"/>
        </createTable>
    </changeSet>


    <changeSet id="20200901.add.table.permission" author="Gsean">
        <createTable tableName="permission">
            <column name="id" type="bigint" autoIncrement="${autoIncrement}">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="parent_id" type="bigint" remarks="父权限id"/>
            <column name="name" type="varchar(255)" remarks="权限名称"/>
            <column name="en_name" type="varchar(255)" remarks="权限英文名"/>
            <column name="url" type="varchar(255)" remarks="权限路径"/>
            <column name="is_deleted" type="boolean" remarks="是否删除" defaultValueBoolean="false"/>
            <column name="create_time" type="datetime" remarks="创建时间" defaultValue="now()"/>
            <column name="modify_time" type="datetime" remarks="更新时间" defaultValue="now()"/>
        </createTable>
    </changeSet>


    <changeSet id="20200901.add.table.role_permission" author="Gsean">
        <createTable tableName="role_permission">
            <column name="id" type="bigint" autoIncrement="${autoIncrement}">
                <constraints primaryKey="true" nullable="false" />
            </column>
            <column name="role_id" type="bigint" remarks="角色id"/>
            <column name="permission_id" type="bigint" remarks="权限id"/>
            <column name="is_deleted" type="boolean" remarks="是否删除" defaultValueBoolean="false"/>
        </createTable>
    </changeSet>


    <changeSet id="20200901.add.column.t_user" author="Gsean">
        <addColumn tableName="t_user">
            <column name="create_time" type="datetime" remarks="创建时间" defaultValue="now()"/>
            <column name="modify_time" type="datetime" remarks="更新时间" defaultValue="now()"/>
        </addColumn>
    </changeSet>


    <changeSet id="20200902.del.column" author="Gsean">
        <dropColumn tableName="user_role" columnName="is_deleted"/>
        <dropColumn tableName="role_permission" columnName="is_deleted"/>
    </changeSet>





</databaseChangeLog>